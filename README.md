# DESCtorch
Deep Embedded Single-cell RNA-seq Clustering implementation with pytorch,  you can find implementation of tensorflow version of DESC in https://github.com/eleozzr/desc.  We will try more complicated network structure and loss function base on DESCtorch in the future!!! I will reproduce all result of this paper in my free time.

![](./workflow/DESC_workflow.png)
## Installtion

```
conda create -n DESCtorch python=3.6.10
conda activate DESCtorch
pip install DESCtorch
```
then you can run the tutorial of DESCtorch for several datasets(in run_dataset folder).
1. ![paul15_tutorial.ipynb](./run_dataset/paul15_tutorial.ipynb)
2. ![pbmc_tutorial.ipynb](./run_dataset/pbmc_tutorial.ipynb)
3. ![macaque_tutorial.ipynb](./run_dataset/macaque_tutorial.ipynb)
4. ![pancreas_tutorial.ipynb](./run_dataset/pancreas_tutorial.ipynb)

### Figure1_reproduce(The workflow of DESC)
I use draw.io to plot the workflow, you can find the source file of draw.io in Figure1_reproduce folder

For compared methods, I will not compare BERMUDA and Seurat2, becuase It's difficult to install and run. I will compare DEST torch with Harmony，BBKNN， fastMNN，scVI，Seurat3，Scanorama to reproduce the result.

### Figure2_reproduce
(Comparison of the robustness of different methods for batch definition based on the macaque retina scRNA-seq data)
**will be updated in my free time**

### Figure3_reproduce
(The Comparison between DESC and scVI when batch information was not provided in the analysis of macaque retina data)
**will be updated in my free time**

### Figure4_reproduce
(Clustering results for the pancreatic islet data generated from different scRNA-seq protocols)
**will be updated in my free time**

### Figure5_reproduce
(The results of PBMC data generated by Kang et al)
**will be updated in my free time**

### Figure6_reproduce
(The results of mouse bone marrow data generated by Paul et al)
**will be updated in my free time**

### Figure7_reproduce
(The estimated pseudotime plots for the human monocyte data)
**will be updated in my free time**





# Reference

Li, X., Wang, K., Lyu, Y., Pan, H., Zhang, J., Stambolian, D., ... & Li, M. (2020). Deep learning enables accurate clustering with batch effect removal in single-cell RNA-seq analysis. *Nature communications*, *11*(1), 1-14.



